<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Client Dashboard — Click & Care</title>

  <!-- Core CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.2.96/css/materialdesignicons.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/main.min.css" rel="stylesheet"/>
  <!-- Your existing theme -->
  <link rel="stylesheet" href="styles.css"/>

  <!-- Readability & theme-safe tweaks (keeps your look) -->
  <style>
    /* Use your theme vars; ensure readable text on dark backgrounds */
    body {
      background: var(--bg);
      color: var(--text, #fff);
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
    }
    .dashboard-container {
      display: grid;
      grid-template-columns: 240px 1fr;
      min-height: 100vh;
      background:
        radial-gradient(900px 600px at 10% -10%, rgba(214,179,91,0.05), transparent 60%),
        radial-gradient(1000px 500px at 90% 10%, rgba(240,210,123,0.05), transparent 60%),
        var(--bg);
    }
    .sidebar {
      background: linear-gradient(180deg, rgba(20,20,25,.95), rgba(15,15,22,.95));
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 2rem 1rem;
      box-shadow: var(--shadow);
      position: sticky; top: 0;
    }
    .sidebar-header h3 { color: var(--brand); font-weight: 800; text-align: center; margin-bottom: 2rem; }
    .sidebar-nav { display: flex; flex-direction: column; gap: .5rem; }
    .sidebar-nav a {
      display:flex; align-items:center; gap:.75rem;
      color:#cfcfcf; text-decoration:none; padding:.75rem 1rem;
      border-radius: 12px; transition:.2s;
    }
    .sidebar-nav a i { font-size: 1.2rem; }
    .sidebar-nav a:hover, .sidebar-nav a.active { background: rgba(214,179,91,.12); color: var(--brand); }

    .main-content { padding: 2rem 2.5rem; background: var(--bg-alt, #0b0b0d); }

    .dashboard-header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 2rem; }
    .dashboard-header h1 { font-weight: 700; font-size: 1.75rem; color: var(--brand); }

    .stats-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap:1.5rem; margin-bottom:2rem; }
    .stat-card {
      background: var(--card, #121217);
      border: 1px solid var(--border, #222);
      border-radius: var(--radius, 16px);
      padding: 1.5rem;
      box-shadow: var(--shadow);
      color: #fff;
    }
    .stat-card h3 { color: var(--muted, #c1b38e); font-size: 1rem; margin-bottom: .5rem; }
    .stat-card .value { font-size: 1.8rem; font-weight: 700; color: var(--brand, #d6b35b); }

    /* Appointments tables — ensure text is white on dark */
    table.appointments-table {
      width: 100%;
      border-collapse: collapse;
      background: var(--card, #121217);
      border-radius: var(--radius, 16px);
      overflow: hidden;
      box-shadow: var(--shadow);
    }
    .appointments-table th {
      background: rgba(214,179,91,0.10);
      color: #fff;
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border, #222);
    }
    .appointments-table td {
      padding: 1rem;
      border-bottom: 1px solid var(--border, #222);
      color: #fff;
    }
    .badge { border-radius: 999px; padding:.4rem .75rem; font-size: .75rem; font-weight: 700; }
    .badge-success { background: rgba(40,167,69,.15); color:#4ade80; }
    .badge-warning { background: rgba(255,193,7,.1); color:#facc15; }
    .badge-primary { background: rgba(214,179,91,.12); color: var(--brand, #d6b35b); }

    .card, .modal-content {
      background: var(--card, #121217);
      color: #fff;
      border: 1px solid var(--border, #222);
      border-radius: var(--radius, 16px);
    }

    .form-label, label { color:#fff; }

    .btn-primary {
      background: var(--brand, #d6b35b);
      color: #0b0b0d;
      border: none;
      font-weight: 600;
      border-radius: 12px;
    }
    .btn-primary:hover { background: #e6c76b; }

    /* FullCalendar dark readability */
    .calendar-card {
      background: linear-gradient(180deg, #101018, #0c0c12);
      border: 1px solid rgba(214,179,91,.18);
      box-shadow: 0 20px 45px rgba(0,0,0,.45);
    }
    .calendar-card h5 { color: var(--brand, #d6b35b); font-weight: 700; letter-spacing: .02em; }
    .fc { color: #f7f7fb; }
    .fc .fc-toolbar.fc-header-toolbar { margin-bottom: 1.5rem; }
    .fc-toolbar-title {
      color: #f5d679;
      text-transform: uppercase;
      letter-spacing: .05em;
      font-size: 1.2rem;
    }
    .fc .fc-button {
      border: 1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.04);
      color:#f9f9fb;
      border-radius: 10px;
      padding:.35rem .9rem;
      text-transform: capitalize;
    }
    .fc .fc-button-primary:not(:disabled).fc-button-active,
    .fc .fc-button-primary:hover {
      background: rgba(214,179,91,.18);
      color:#f5d679;
    }
    .fc-theme-standard .fc-scrollgrid { border: 1px solid rgba(255,255,255,.08); }
    .fc-theme-standard td,
    .fc-theme-standard th { border-color: rgba(255,255,255,.08); }
    .fc-theme-standard .fc-col-header-cell {
      background: rgba(8,8,12,.96);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .fc-theme-standard .fc-col-header-cell-cushion {
      color:#f3f5ff;
      font-size:.9rem;
      font-weight:700;
      letter-spacing:.08em;
      text-transform: uppercase;
    }
    .fc-daygrid-day { background: rgba(8,8,12,.9); }
    .fc-daygrid-day-top { flex-direction: row; padding:.35rem; }
    .fc-daygrid-day-number { color:#fff; font-weight:600; }
    .fc-daygrid-day.fc-day-today { background: rgba(214,179,91,.15); }
    .fc-daygrid-day.fc-day-other { opacity:.45; }
    .fc-event {
      border-radius: 10px;
      border-width: 1px !important;
      padding: 4px 8px;
      font-weight: 600;
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
      color: #fff9df !important;
      backdrop-filter: blur(4px);
    }
    .fc-event .fc-event-main { color: inherit; letter-spacing: .01em; }
    .fc-event .fc-event-title,
    .fc-event .fc-event-time { color: inherit !important; }
    .fc .fc-list-table { background: rgba(8,8,12,.95); }
    .fc-list-sticky .fc-list-day { background: transparent; }
    .fc .fc-list-day-cushion {
      background: linear-gradient(90deg, rgba(255,255,255,.96), rgba(255,255,255,.72));
      color:#b48c2c;
      font-size:.9rem;
      font-weight:800;
      letter-spacing:.08em;
      text-transform: uppercase;
      border-bottom: 1px solid rgba(255,255,255,.08);
      box-shadow: inset 0 -1px 0 rgba(0,0,0,.15);
    }
    .fc .fc-list-event-time,
    .fc .fc-list-event-title { color:#fff9df; font-weight:600; }
    .fc .fc-list-event:hover td { background: rgba(214,179,91,.08); }

    @media (max-width: 800px) {
      .dashboard-container { grid-template-columns: 1fr; }
      .sidebar { position: relative; height:auto; padding:1.5rem; }
    }

  </style>
</head>

<body>
  <div class="dashboard-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div>
        <div class="sidebar-header"><h3>Click & Care</h3></div>
        <nav class="sidebar-nav">
          <a href="#" id="dashboardNav" class="active"><i class="mdi mdi-view-dashboard"></i> Dashboard</a>
          <a href="#" id="appointmentsNav"><i class="mdi mdi-calendar-clock"></i> Appointments</a>
          <a href="#" id="accountNav"><i class="mdi mdi-account-circle"></i> My Account</a>
          <a href="#" id="billingNav"><i class="mdi mdi-credit-card"></i> Billing</a>
          <a href="#" id="supportNav"><i class="mdi mdi-headset"></i> Support</a>
        </nav>
      </div>
      <a href="client.html" id="logoutLink" class="sidebar-nav mt-4">
        <i class="mdi mdi-logout"></i> Log Out
      </a>
    </aside>

    <!-- Main -->
    <main class="main-content">
      <div class="dashboard-header">
        <h1>Welcome back, <span id="userName">Client</span></h1>
        <div class="d-flex align-items-center gap-2">
          <button class="btn btn-primary" id="newAppointmentBtn">
            <i class="mdi mdi-plus"></i> New Appointment
          </button>
        </div>
      </div>

      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-card">
          <h3>Active Support Plan</h3>
          <div class="value" id="planName">—</div>
        </div>
        <div class="stat-card">
          <h3>Visits Left</h3>
          <div class="value" id="visitsLeft">0</div>
          <div>of <span id="visitsTotal">0</span> this period</div>
        </div>
        <div class="stat-card">
          <h3>Dedicated Technician</h3>
          <div class="value" id="dedicatedTech">—</div>
        </div>
      </div>

      <h4 class="mb-3" style="color:#f5d679;">Upcoming & Pending</h4>
      <table class="appointments-table mb-4">
        <thead>
          <tr>
            <th>Service</th>
            <th>Date</th>
            <th>Technician</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="upcomingTbody"></tbody>
      </table>

      <h4 class="mb-3" style="color:#f5d679;">Completed History</h4>
      <table class="appointments-table">
        <thead>
          <tr>
            <th>Service</th>
            <th>Date</th>
            <th>Technician</th>
            <th>Status</th>
            <th>Notes</th>
          </tr>
        </thead>
        <tbody id="historyTbody"></tbody>
      </table>

      <!-- Calendar (like worker-appointments) -->
      <section id="calendarSection" class="d-none">
        <div class="card calendar-card p-3 mt-4">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <h5 class="m-0 text-warning"><i class="mdi mdi-calendar"></i> Appointment Calendar</h5>
          </div>
          <div id="calendar"></div>
        </div>
      </section>
    </main>
  </div>

  <!-- Toasts -->
  <div class="position-fixed top-0 end-0 p-3" style="z-index:1080">
    <div id="toastContainer" class="toast-container"></div>
  </div>

  <!-- New Appointment Modal -->
  <div class="modal fade" id="appointmentModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">New Appointment</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="appointmentForm" class="vstack gap-2">
            <div>
              <label class="form-label">Date</label>
              <input type="date" class="form-control" id="apptDate" required>
            </div>
            <div>
              <label class="form-label">Time</label>
              <input type="time" class="form-control" id="apptTime" required>
            </div>
            <div>
              <label class="form-label">Service</label>
              <select id="apptService" class="form-select" required>
                <option>System Support</option>
                <option>Troubleshooting</option>
                <option>Installation</option>
                <option>Maintenance</option>
              </select>
            </div>
            <div>
              <label class="form-label">Notes</label>
              <textarea id="apptNotes" rows="3" class="form-control" placeholder="Describe your issue or request"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" id="saveAppointmentBtn">
            <span class="spinner-border spinner-border-sm me-2 d-none" id="saveApptSpinner"></span>
            Schedule
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Account Modal -->
  <div class="modal fade" id="accountModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">My Account</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row g-3" id="accountDetails"><!-- filled by JS --></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal fade" id="settingsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Edit Account</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="settingsForm" class="vstack gap-2">
            <label class="form-label">Full name</label>
            <input type="text" id="setName" class="form-control" required>
            <label class="form-label">Email</label>
            <input type="email" id="setEmail" class="form-control" required>
            <label class="form-label">New Password</label>
            <div class="input-group">
              <input type="password" id="setPassword" class="form-control" placeholder="Leave blank to keep current">
              <button class="btn btn-outline-secondary" type="button" id="toggleSetPwd"><i class="mdi mdi-eye"></i></button>
            </div>
            <label class="form-label mt-2">Current Password (required to change password)</label>
            <input type="password" id="setCurrentPassword" class="form-control" placeholder="Only needed if setting a new password">
            <label class="form-label">Plan</label>
            <select id="setPlan" class="form-select">
              <option value="Assurance">Assurance</option>
              <option value="Comfort">Comfort</option>
              <option value="Concierge">Concierge</option>
            </select>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" id="saveSettingsBtn">
            <span class="spinner-border spinner-border-sm me-2 d-none" id="saveSettingsSpinner"></span>
            Save Changes
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Billing Modal -->
  <div class="modal fade" id="billingModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Billing & Plans</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p class="text-muted mb-3">
            Choose the product that fits your needs. You’ll be redirected to a secure Stripe checkout page for payment.
          </p>
          <div class="row g-3" id="billingPlans">
            <div class="col-md-6">
              <div class="p-3 border rounded bg-dark text-white h-100">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <h6 class="m-0 text-warning">Concierge Care</h6>
                  <span class="badge bg-primary">$149/mo</span>
                </div>
                <ul class="mb-3 small">
                  <li>Dedicated technician</li>
                  <li>Proactive & preventive white-glove care</li>
                  <li>$69/hr preferred rate</li>
                </ul>
                <button class="btn btn-primary w-100 billing-link-btn" data-link-id="conciergeMonthly">
                  <i class="mdi mdi-credit-card"></i> Pay with Stripe
                </button>
              </div>
            </div>

            <div class="col-md-6">
              <div class="p-3 border rounded bg-dark text-white h-100">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <h6 class="m-0 text-warning">Annual Membership</h6>
                  <span class="badge bg-success">$159/yr</span>
                </div>
                <ul class="mb-3 small">
                  <li>One annual check-in included</li>
                  <li>Priority access</li>
                  <li>$89/hr member rate</li>
                </ul>
                <button class="btn btn-success w-100 billing-link-btn" data-link-id="annualMembership">
                  <i class="mdi mdi-credit-card"></i> Pay with Stripe
                </button>
              </div>
            </div>

            <div class="col-md-6">
              <div class="p-3 border rounded bg-dark text-white h-100">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <h6 class="m-0 text-warning">One Visit / Month Promo</h6>
                  <span class="badge bg-primary">$129/mo</span>
                </div>
                <ul class="mb-3 small">
                  <li>1 visit per month</li>
                  <li>Designed to convert into membership</li>
                </ul>
                <button class="btn btn-primary w-100 billing-link-btn" data-link-id="monthlyPromo">
                  <i class="mdi mdi-credit-card"></i> Pay with Stripe
                </button>
              </div>
            </div>

            <div class="col-md-6">
              <div class="p-3 border rounded bg-dark text-white h-100">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <h6 class="m-0 text-warning">One Annual Check-in Promo</h6>
                  <span class="badge bg-success">$135/yr</span>
                </div>
                <ul class="mb-3 small">
                  <li>Includes annual check-in</li>
                  <li>Priority access</li>
                </ul>
                <button class="btn btn-success w-100 billing-link-btn" data-link-id="annualPromo">
                  <i class="mdi mdi-credit-card"></i> Pay with Stripe
                </button>
              </div>
            </div>

            <div class="col-md-6">
              <div class="p-3 border rounded bg-dark text-white h-100">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <h6 class="m-0 text-warning">Welcome Flat Fee</h6>
                  <span class="badge bg-info text-dark">$1</span>
                </div>
                <ul class="mb-3 small">
                  <li>One-time flat fee</li>
                </ul>
                <button class="btn btn-info w-100 billing-link-btn" data-link-id="welcomeFlightFee">
                  <i class="mdi mdi-credit-card"></i> Pay with Stripe
                </button>
              </div>
            </div>

            <div class="col-md-6">
              <div class="p-3 border rounded bg-dark text-white h-100">
                <div class="d-flex justify-content-between align-items-center mb-1">
                  <h6 class="m-0 text-warning">Non-member Hourly</h6>
                  <span class="badge bg-danger">$119/hr</span>
                </div>
                <ul class="mb-3 small">
                  <li>No priority access</li>
                  <li>No dedicated technician</li>
                  <li>Pay-as-you-go</li>
                </ul>
                <button class="btn btn-outline-light w-100 billing-link-btn" data-link-id="nonMemberHourly">
                  <i class="mdi mdi-credit-card"></i> Pay with Stripe
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Support Modal -->
  <div class="modal fade" id="supportModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Contact Support</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <a href="tel:19176910062" class="btn btn-outline-primary w-100 mb-2"><i class="mdi mdi-phone"></i> Call: 917-691-0062</a>
          <a href="mailto:irgrustam@gmail.com" class="btn btn-outline-primary w-100"><i class="mdi mdi-email"></i> Email: irgrustam@gmail.com</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Vendor Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>

  <!-- Your app logic (will be provided next) -->
  <script type="module" src="client-dashboard.js"></script>
</body>
</html>
